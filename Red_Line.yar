rule Redline_Malware {
   meta:
      description = "DETECTING Redline_Malware"
      author = "Mustafa Hussein"
      date = "2022-01-23"
      hash1 = "166e01990d47a94b5a36a98916c96d297746517086c83a8e4736c283255b7979"
   strings:
      $x1 = "C:\\Windows\\system32\\api-ms-win-core-localization-l1-2-1.DLL"  wide
      $str2 = "EntityTUwSystem.ServiceModel.SessionMode, System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" 
      $str3 = "System.Security.Permissions.SecurityPermissionAttribute, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934" 
      $str4 = "C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\AppLaunch.exe"  wide
      $str5 = "Renounce.exe"  wide
      $str6 = "DownloadAndExecuteUpdate"  
      $str7 = "ID: isSecureegram.exe"  wide
      $str8 = "%appdata%\\"  wide
      $str9 = "coMANGOokies.sqMANGOliteAFileSystemntivFileSystemirusPrFileSystemoduFileSystemct|AntiFileSystemSpyWFileSystemareProFileSystemduc" wide
      $str10 = "get_encrypted_key"  
      $str11 = "%appdata%\\discord\\Local Storage\\leveldb"  wide
      $str12 = "SSystem.ELECT * FRSystem.OM WiSystem.n32_ProcSystem.ess WherSystem.e SessiSystem.onId='"  wide
      $str13 = "GetDecoded"  
      $str14 = "TryInitProcesses"  
      $str15 = "        <requestedExecutionLevel level=\"asInvoker\" uiAccess=\"false\"/>"  
      $str16 = "System.Collections.Generic.IEnumerable<Entity5>.GetEnumerator"  
      $str17 = "ListOfProcesses"  
      $str18 = "System.Collections.Generic.IEnumerator<Entity5>.get_Current"  
      $str19 = "loginPairs"  
      $str20 = "ITaskProcessor"  
   condition:
      uint16(0) == 0x5a4d and filesize < 3000KB and
      1 of ($x*) and 4 of them
}

